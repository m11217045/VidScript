# YouTube 財經報告生成器 v2.0 使用說明

## 📋 快速開始指南

### 🚀 第一次使用（必須按順序執行）

1. **執行環境修復**
   ```
   雙擊 修復.bat
   ```
   - 這會自動安裝 Python 虛擬環境
   - 下載並安裝所有必要的套件
   - 設定正確的環境配置
   - **⚠️ 這個步驟可能需要 5-10 分鐘，請耐心等待**

2. **開始使用程式**
   ```
   雙擊 Run.bat
   ```
   - 啟動 YouTube 財經報告生成器
   - 開啟圖形化使用者介面

### 📁 檔案說明

| 檔案名稱 | 用途 | 說明 |
|---------|------|------|
| `修復.bat` | 環境安裝 | 第一次使用或出現問題時執行 |
| `Run.bat` | 啟動程式 | 日常使用的主要啟動檔案 |
| `download.py` | 主程式 | Python 核心程式碼 |
| `requirements.txt` | 套件清單 | 列出所有需要的 Python 套件 |
| `.env` | 環境變數 | 儲存 API Keys（需要手動設定） |
| `診斷工具.bat` | 故障排除 | 當程式無法正常運作時使用 |

### 🔑 API Key 設定

程式需要 AI API Key 才能生成報告：

#### 方法一：環境變數檔案設定
1. 編輯 `.env` 檔案（如果不存在會自動建立）
2. 填入您的 API Key：
   ```
   GOOGLE_API_KEY=你的_Gemini_API_Key
   OPENAI_API_KEY=你的_OpenAI_API_Key
   ```

#### 方法二：程式內手動輸入
- 在程式介面中直接輸入 API Key

### 💡 使用流程

1. **啟動程式**：執行 `Run.bat`
2. **輸入影片網址**：貼上 YouTube 影片連結
3. **選擇 AI 提供商**：Gemini 或 OpenAI
4. **輸入 API Key**：如果 .env 檔案已設定則會自動載入
5. **設定儲存路徑**：選擇報告儲存位置（預設為程式目錄）
6. **開始生成**：點擊「開始生成報告」按鈕

### 🔧 系統需求

- **作業系統**：Windows 10/11
- **Python**：3.8 或更高版本
- **網路連線**：下載影片和使用 AI API
- **儲存空間**：至少 2GB 可用空間

### 🎯 功能特色

- ✅ **智慧字幕優先**：自動檢測並使用 YouTube CC 字幕
- ✅ **語音轉文字備援**：無字幕時使用 Whisper 進行語音識別
- ✅ **多 AI 支援**：支援 Google Gemini 和 OpenAI GPT
- ✅ **GPU 加速**：自動檢測並使用 GPU 加速（如果可用）
- ✅ **中文優化**：針對中文財經內容優化
- ✅ **Markdown 輸出**：生成格式化的財經報告

### 📊 處理流程

```
YouTube 影片 → 檢查字幕 → 下載音訊 → 語音轉文字 → AI 分析 → 生成報告
     ↓              ↓           ↓           ↓          ↓          ↓
   輸入網址    → CC字幕優先 → Whisper備援 → 文字處理 → AI潤飾 → Markdown報告
```

### ❗ 常見問題解決

#### 問題 1：程式無法啟動
**解決方案**：
```
1. 執行 診斷工具.bat 檢查問題
2. 重新執行 修復.bat
3. 確認 Python 已正確安裝
```

#### 問題 2：出現亂碼
**解決方案**：
```
1. 使用系統管理員權限執行
2. 確認系統支援 UTF-8 編碼
3. 重新啟動電腦後再試
```

#### 問題 3：GPU 無法使用
**解決方案**：
```
1. 檢查 NVIDIA 驅動是否最新
2. 確認安裝了 CUDA 支援的 PyTorch
3. 程式會自動回退到 CPU 模式
```

#### 問題 4：API 呼叫失敗
**解決方案**：
```
1. 檢查 API Key 是否正確
2. 確認網路連線正常
3. 檢查 API 配額是否用完
```

### 🔄 更新與維護

- **定期更新**：執行 `修復.bat` 更新套件
- **清理暫存**：程式會自動清理暫存檔案
- **備份設定**：建議備份 `.env` 檔案

### 📞 技術支援

如果遇到其他問題：

1. **查看錯誤日誌**：程式介面下方的日誌區域
2. **執行診斷工具**：`診斷工具.bat`
3. **重新安裝環境**：`修復.bat`
4. **檢查系統相容性**：確認 Python 和系統版本

### 🌟 使用技巧

- **批次處理**：可以依序處理多個影片
- **品質設定**：較長影片建議使用 GPU 加速
- **網路環境**：穩定的網路連線可提高成功率
- **API 選擇**：Gemini 通常響應較快，OpenAI 分析較詳細

---

## 🎯 一鍵啟動

```
第一次使用：修復.bat → Run.bat
日常使用：Run.bat
```

**祝您使用愉快！** 🚀
